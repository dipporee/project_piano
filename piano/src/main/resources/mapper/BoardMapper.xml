<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="com.piano.mapper.BoardMapper">

	<!-- 목록 조회 -->
	<select id="getList" resultType="com.piano.vo.BoardVO">
	    SELECT
	        B.BOARD_SEQ,
	        B.BOARD_TITLE,
	        B.BOARD_TEXT,
	        B.REG_DT,
	        B.BOARD_VIEW,
	        U.USER_NICKNAME
	    FROM BOARD B
	    JOIN USER U ON B.REG_USER_SEQ = U.REG_USER_SEQ
	    WHERE B.DEL_YN = 'N'
	    ORDER BY B.REG_DT DESC
	</select>
	
	<!-- 글 작성 -->
	<insert id="contentWrite" parameterType="com.piano.vo.BoardVO"> 		
		INSERT INTO BOARD
			(				
				BOARD_TITLE,
				BOARD_TEXT,
				BOARD_GRP_SEQ, 
        		REG_USER_SEQ,
				REG_DT
			)
		VALUES
			(	
				#{boardTitle},
				#{boardText},
				#{boardGrpSeq},  
        		#{regUserSeq},
				NOW()
			)
	</insert> 
	
	
	<!-- 최신 글번호 -->
	<select id="boardSeq" resultType="int"> 
		SELECT 
			MAX(BOARD_SEQ) 
		FROM BOARD
	</select> 


	<!-- 글 조회 -->
	<select id="getContent" parameterType="long" resultType="com.piano.vo.BoardVO"> 	
		<![CDATA[ 
			SELECT
				  BOARD_SEQ 
				, BOARD_TITLE 
				, BOARD_TEXT 
				, REG_DT 
				, BOARD_VIEW 
			FROM BOARD 
			WHERE BOARD_SEQ = #{boardSeq}  
		]]> 
	</select> 
	
	<!-- 글 수정 -->
	<update id="contentModify" parameterType="com.piano.vo.BoardVO"> 
		UPDATE BOARD
		SET   BOARD_TITLE = #{boardTitle}
			, BOARD_TEXT = #{boardText} 
		WHERE BOARD_SEQ = #{boardSeq} 	
	</update> 
	
	
	<!-- 글 삭제 -->
	<update id="contentDelete" parameterType="long"> 
		UPDATE BOARD
		SET DEL_YN = 'Y'
		WHERE BOARD_SEQ = #{boardSeq}
	</update>
	
	
	

</mapper>	